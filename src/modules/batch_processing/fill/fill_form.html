<!-- Created by Tien Bui on 10/30/2017 -->
<div>
    <form name="paymentsBatchProcessingFormForm">
        <div class="account-collapse-item form-horizontal">
            <bd-header>{{ ::'ocb.payments.batch_processing.personal' | translate }}</bd-header>
            <bd-item-property-form label="{{ ::'ocb.payments.new.domestic.fill.sender_account' | translate }}">
                <!--<input name="remitterAccountId" hidden ng-model="payment.formData.remitterAccountId" required/>-->
                <rb-account-select rb-batch-info-search="paymentsBatchProcessingForm.batchInfoSearch"
                        rb-product-list-name="TRANSFER_FROM_LIST"
                        rb-account-restrictions="ACCOUNT_RESTRICTION_DEBIT"
                        rb-account="paymentsBatchProcessingForm.formData.selectedAccount"
                        rb-account-no="paymentsBatchProcessingForm.formData.senderAccountId"
                        rb-on-account-select="onSenderAccountSelect($accountId)"
                        bd-attr-required="true"
                        rb-account-list="paymentsBatchProcessingForm.formData.accountList"
                        rb-account-select-params="senderSelectParams"
                        rb-remote="remote.model"
                ></rb-account-select>
                <!--rb-init-select-value = "{{ payment.formData.accountNo || selectNrb}}"-->

                <!--rb-account-no="payment1.items.recipient.srcAccountNo"-->
            </bd-item-property-form>
            <bd-item-property-form ng-if="paymentsBatchProcessingForm.formData.selectedAccount" ng-disabled="paymentsBatchProcessingForm.batchInfoSearch"
                              label="{{ ::'ocb.payments.batch_processing.name' | translate }}" class="accesibleAssetsInline accesibleAssetsBold">
                <div class="bd-amount" ng-class="{'not-styled': notStyled, 'amount-negative': highlightNegative &&  amount < 0}">
                    <span class="bd-amount__value">{{paymentsBatchProcessingForm.formData.selectedAccount.accountName| uppercase}}</span>
                    <span class="bd-amount__currency" ng-show="!showDash"></span>
                    <span class="dash" ng-show="showDash">-</span>
                </div>
            </bd-item-property-form>
            <bd-item-property-form ng-if="paym0entsBatchProcessingForm.formData.selectedAccount" ng-disabled="paymentsBatchProcessingForm.batchInfoSearch"
                              label="{{ ::'ocb.payments.batch_processing.ocbbranch' | translate }}" class="accesibleAssetsInline accesibleAssetsBold">
                <div class="bd-amount" ng-class="{'not-styled': notStyled, 'amount-negative': highlightNegative &&  amount < 0}">
                    <span class="bd-amount__value">Tan Binh???</span><span class="bd-amount__currency" ng-show="!showDash"></span>
                    <span class="dash" ng-show="showDash">-</span>
                </div>
            </bd-item-property-form>

            <bd-item-property-form ng-if="paymentsBatchProcessingForm.formData.selectedAccount" ng-disabled="paymentsBatchProcessingForm.batchInfoSearch"
                              label="{{ ::'ocb.payments.new.domestic.fill.accessible_assets' | translate }}" class="accesibleAssetsInline accesibleAssetsBold">
                <bd-amount amount="paymentsBatchProcessingForm.formData.selectedAccount.accessibleAssets"
                           currency="{{ paymentsBatchProcessingForm.formData.selectedAccount.currency }}"></bd-amount>
            </bd-item-property-form>

            <bd-item-property-form ng-if="paymentsBatchProcessingForm.formData.selectedAccount" ng-disabled="paymentsBatchProcessingForm.batchInfoSearch"
                              label="{{ ::'ocb.payments.batch_processing.remainingdailylimit' | translate }}" class="accesibleAssetsInline accesibleAssetsBold">
                <bd-amount amount="paymentsBatchProcessingForm.formData.selectedAccount.accessibleAssets"
                           currency="{{ paymentsBatchProcessingForm.formData.selectedAccount.currency }}???"></bd-amount>
            </bd-item-property-form>

            <bd-item-property-form label="{{ ::'ocb.payments.batch_processing.transactiontype' | translate }}" ng-disabled="paymentsBatchProcessingForm.batchInfoSearch">
                <ui-select ng-disabled="paymentsBatchProcessingForm.batchInfoSearch"
                        ng-model="paymentsBatchProcessingForm.formData.selectedTransactionType"
                           theme="bootstrap"
                           on-select="onTransactionTypeChanged($select.selected)"
                           required>
                    <ui-select-match placeholder="{{ ::'ocb.payments.batch_processing.transactiontype' | translate }}">
                        {{$select.selected.typeName}}
                    </ui-select-match>
                    <ui-select-choices repeat="transactionType in transaction_types | filter: $select.search track by $index">
                        <div ng-bind-html="transactionType.typeName | highlight: $select.search"></div>
                    </ui-select-choices>
                </ui-select>
            </bd-item-property-form>

            <bd-item-property-form label="{{ ::'ocb.payments.batch_processing.subaccount' | translate  }}" ng-disabled="paymentsBatchProcessingForm.batchInfoSearch">
                <ui-select ng-disabled="paymentsBatchProcessingForm.batchInfoSearch"
                        ng-model="paymentsBatchProcessingForm.formData.selectedSubAccount"
                           theme="bootstrap"
                           on-select="onSubAccountChanged($select.selected)"
                           required>
                    <ui-select-match placeholder="Sub Account">
                        {{$select.selected.accountName}} {{$select.selected.accountNo}}
                    </ui-select-match>
                    <ui-select-choices repeat="subAccount in subAccountList | filter: $select.search track by $index">
                        <!--<div ng-bind="subAccount.accountNo | highlight: $select.search"></div>-->
                        <div class="rb-account-select__account-name-row" ng-bind="subAccount.accountName"></div>
                        <div class="rb-account-select__account-desc-row" ng-show="noSubAccount">
                            <span class="rb-account-select__account-desc-row__nrb hidden-xs hidden-sm" ng-bind="subAccount.accountNo | nrbIbanFilter | highlight: $select.search"></span>
                            <span class="rb-account-select__account-desc-row__nrb hidden-md hidden-lg" ng-bind="subAccount.accountNo | nrbAccountSelectIbanShortFilter | highlight: $select.search"></span>
                            <span class="rb-account-select__account-desc-row__amount" ng-bind="((subAccount.accessibleAssets | currency:'') + ' ' + subAccount.currency) | highlight: $select.search"></span>
                        </div>
                    </ui-select-choices>
                </ui-select>
            </bd-item-property-form>
        </div>
        <div class="account-collapse-item form-horizontal" ng-show="paymentsBatchProcessingForm.batchInfoSearch">
            <bd-header>{{ ::'ocb.payments.batch_processing.beneficiarylist' | translate }}</bd-header>
            <bd-item-property-form label="{{ ::'ocb.payments.batch_processing.uploadfile' | translate }}">
                <div class="input-group form-btn">
                    <!--<div class="addfile-block" style="">
                        <div class="form-control file-name"></div>
                        <label class="filelb">
                            <input type="file">
                            <img ng-src="{{svgPath}}" width="37" height="37"/>
                        </label>
                    </div>-->
                    <input style="cursor: pointer" type="file" id="uploadFile" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"/>
                    <span class="display-group">
                        <bd-button class="bd-button__primary bd-button" ng-click="tienTest()">{{::'ocb.payments.batch_processing.upload'|translate}}</bd-button>
                    </span>
                </div>
            </bd-item-property-form>
            <bd-item-property-form>
                <div class="input-group">
                    <a class="bd-button" ng-show="isInternal" ng-click="downloadTemplateInternal()">{{ ::'ocb.payments.batch_processing.download.template' | translate }}</a>
                    <a class="bd-button" ng-show="isExternal" ng-click="downloadTemplateExternal()">{{ ::'ocb.payments.batch_processing.download.template' | translate }}</a>
                </div>
            </bd-item-property-form>
        </div>

        <!--Table section-->
        <div class="account-collapse-item form-btn" ng-show="paymentsBatchProcessingForm.validTableShow">
            <span class="display-group padding-bottom-5">
                <bd-button class="bd-button__primary bd-button" ng-click="downloadTable()">{{::'ocb.payments.batch_processing.download.excelTable'|translate}}</bd-button>
            </span>
            <bd-table
                    bd-display-bank-code="displayBankCode"
                    bd-type="typeBP"
                    bd-table-params="tableValid.tableConfig"
                    bd-table-control="tableValid.tableControl"
                    bd-table-data="tableValid.tableData"
                    bd-table-promise="testDataPromise"
                    bd-table-meta="{
                        'first':{
                            'title': '##ocb.payments.batch_processing.table.fullname',
                            'data': 'fullName'
                        },
                        'second':{
                            'title': '##ocb.payments.batch_processing.table.accountno',
                            'data': 'accountNo'
                        },
                        'third':{
                            'title': '##ocb.payments.batch_processing.table.bankcode',
                            'data': 'bankCode'
                        },
                        'fourth':{
                            'title': '##ocb.payments.batch_processing.table.amount',
                            'data': 'amount'
                        },
                        'fifth':{
                            'title': '##ocb.payments.batch_processing.table.remarks',
                            'data': 'description'
                        }
                    }"
            >
            </bd-table>
            <div class="form-horizontal margin-top-10">
                <bd-item-property-form class="no-margin-bottom no-padding-top form-group-detail" label="{{ ::'ocb.payments.batch_processing.table.totalamountinfigures' | translate }}"><span class="yellow-label">{{paymentsBatchProcessingForm.formData.totalamountinfigures}} {{ paymentsBatchProcessingForm.params.selectedAccount.currency }}</span></bd-item-property-form>
                <bd-item-property-form class="no-margin-bottom no-padding-top form-group-detail" label="{{ ::'ocb.payments.batch_processing.table.totalamountinwords' | translate }}">{{paymentsBatchProcessingForm.formData.totalamountinwords}} {{ selectedAccount.currency }}</bd-item-property-form>
                <bd-item-property-form class="no-margin-bottom no-padding-top form-group-detail" label="{{ ::'ocb.payments.batch_processing.table.totalamountinwords' | translate }}">{{paymentsBatchProcessingForm.formData.totalamountinwordsen}} {{ selectedAccount.currency }}</bd-item-property-form>
                <bd-item-property-form class="no-margin-bottom no-padding-top form-group-detail" label="{{ ::'ocb.payments.batch_processing.table.totalnumberoflines' | translate }}">{{paymentsBatchProcessingForm.formData.totalnumberoflines}}</bd-item-property-form>
            </div>

            <span class="display-group padding-bottom-5" ng-show="paymentsBatchProcessingForm.invalidTableShow">
                <bd-button class="bd-button__primary bd-button" ng-click="downloadTableInvalid()">{{::'ocb.payments.batch_processing.download.excelTable'|translate}}</bd-button>
            </span>
            <bd-table
                    ng-show="paymentsBatchProcessingForm.invalidTableShow"
                    bd-display-bank-code="displayBankCode"
                    bd-type="typeBP"
                    bd-table-params="tableInvalid.tableConfig"
                    bd-table-control="tableInvalid.tableControl"
                    bd-table-data="tableInvalid.tableData"
                    bd-table-promise="testDataPromise"
                    bd-table-meta="{
                        'first':{
                            'title': '##ocb.payments.batch_processing.table.fullname',
                            'data': 'fullName'
                        },
                        'second':{
                            'title': '##ocb.payments.batch_processing.table.accountno',
                            'data': 'accountNo'
                        },
                        'third':{
                            'title': '##ocb.payments.batch_processing.table.bankcode',
                            'data': 'bankCode'
                        },
                        'fourth':{
                            'title': '##ocb.payments.batch_processing.table.amount',
                            'data': 'amount'
                        },
                        'fifth':{
                            'title': '##ocb.payments.batch_processing.table.remarks',
                            'data': 'description'
                        }
                    }"
            >
            </bd-table>
        </div>
    </form>
</div>


